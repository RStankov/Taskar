<% javascript_response do %>
  (function(){
    var content = "<%= escape_javascript(render @comment) %>",
        comment = $('comment_<%= @comment.id %>');
        
    if (comment){
			comment.morph({
				change: function(){
	      	comment.replace(content);
				}
			});
    } else {
      Taskar.Sections.resetForm($('new_comment').down('form'));
      $('comments').show().down('ul').insert({bottom: content});
      $('comment_<%= @comment.id %>').hide().slideDown();
      $('comments_count').update("<%= @comment.task.comments.count %>");
    }
  })();
<% end %>
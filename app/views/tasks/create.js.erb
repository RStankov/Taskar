<%= javascript_response do %>
  (function(){
    <% if higher_item = @task.higher_item %>
      var content = <%= javascript_string_from_partial @task %>,
          before  = $("<%= dom_id @task.higher_item %>");
      if (before){
        before.insert({after: content});
      } else {
        $("new_task").insert({before: content});
      }
    <% else %>
      $("tasks").insert({top: <%= javascript_string_from_partial @task %>});
    <% end %>
    $("<%= dom_id @task %>").hide().slideDown(function(e){
      new Taskar.FX.ScrollTo(e.element);
    });
    Taskar.Sections.resetTaskForm($('new_task').down('form').show(), '<%= @task.id %>')
  })();
<% end %>